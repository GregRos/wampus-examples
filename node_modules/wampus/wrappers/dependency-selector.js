"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const json_1 = require("../core/serializer/json");
const websocket_1 = require("../core/transport/websocket");
const errors_1 = require("./errors");
/**
 * @internal
 */
var DependencyDeclarations;
(function (DependencyDeclarations) {
    function serializer(declr) {
        if (declr === "json") {
            return new json_1.JsonSerializer();
        }
        else if (typeof declr.deserialize === "function") {
            return declr;
        }
        else {
            if (typeof declr === "string") {
                throw errors_1.Errors.Creation.unknownSerializerName(declr);
            }
            else {
                throw errors_1.Errors.Creation.unknownSerializer(declr);
            }
        }
    }
    DependencyDeclarations.serializer = serializer;
    function transport(config) {
        if (typeof config === "function") {
            return config;
        }
        else if (config.type === "websocket") {
            let transportData = config;
            let slzr = serializer(config.serializer);
            return () => {
                return websocket_1.WebsocketTransport.create({
                    serializer: slzr,
                    timeout: transportData.timeout,
                    url: transportData.url,
                });
            };
        }
        else {
            if (typeof config.type === "string") {
                throw errors_1.Errors.Creation.unknownTransportName(config.type);
            }
            else {
                throw errors_1.Errors.Creation.unknownTransport(config);
            }
        }
    }
    DependencyDeclarations.transport = transport;
})(DependencyDeclarations = exports.DependencyDeclarations || (exports.DependencyDeclarations = {}));
//# sourceMappingURL=dependency-selector.js.map